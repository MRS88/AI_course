'''Задача 1
Загрузите базу температур любым удобным способом. Выведите базу. Посчитайте число пустых записей в столбце State.
Ссылка на скачивание базы: https://drive.google.com/file/d/1bLiz_81Kb4pMryEalRe66jS38_F6vwMX/view?usp=sharing'''

import pandas as pd

data = pd.read_csv('/content/drive/My Drive/city_temperature.csv')
print(data[::10000].head(10))
print()
data['State'].isna().sum()


'''Задача 2
Заполните пустые данные в базе словом "No". Запишите результат в ту же переменную. Выведите ее на экран.'''

data = data.fillna(value='No')
data


'''Задание 3
При помощи метода Pandas определите число уникальных записей в столбцах "Country", "City", "Year".'''

data[['Country', 'City', 'Year']].nunique()


'''Задача 4
При помощи библиотеки Pandas выведите строки, где в столбце "Country" встречается страна "Russia"
При помощи метода Pandas отдельно выведите число элементов в этой выборке.'''

mask = data['Country'] == 'Russia'
data[mask]


'''Задача 5
Создайте новый столбец температур, в котором будут записаны те же значения AvgTemperature, 
но в градусах Цельсия (исходная единица измерения - градусы Фаренгейта).'''

# так как есть строковые данные 'No' в столбце
try:
  celc = ((data['AvgTemperature'] - 32) * 5 / 9).round(1)
except TypeError:
  pass
data.assign(AvgTempCelc = celc)
