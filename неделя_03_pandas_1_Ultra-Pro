'''Представим ситуацию. Вы заказали базу у фрилансеров. Им необходимо было скачать с сайтов двух отелей анонимную базу данных, о всех клиентах. 
Фрилансеры выполнили заказ и прислали работу. Как оказалось, исходные данные очень загрязнены (пустыми колонками, неинформативными строками и т.д), да еще и представлены в виде нескольких различных файлов. 
Главная задача на всё ДЗ - очистить базу и сохранить в виде одного документа.
Ссылка на файлы: https://drive.google.com/drive/folders/12aykvz02214Q_7eNMm3loXzOIDXfeZ4b?usp=sharing
Лучше сохранить на свой Google Диск

Задание 1
Подключите Google Drive.
Откройте папку с файлами и сохраните каждый из них в виде Pandas DataFrame.
Подсказка 1: получить список имен файлов можно при помощи библиотеки os, командой os.listdir(путькпапкесфайлами).
Подсказка 2: для сохранения всех файлов в виде Pandas DataFrame удобно использовать одну из структур данных Python
Объедините все Pandas DataFrame в один.'''

import pandas as pd
import os

path = '/content/drive/My Drive/bookings/'
dirs = os.listdir(path)
data = pd.DataFrame()
for file in dirs:
  data = pd.concat([data, pd.read_csv(path + file)])
  
  
'''Задание 2
Хорошо бы понимать с какими данными мы работаем.
Узнайте размерность получившегося DataFrame (число столбцов и число строк).
Проверьте, выведя график, есть ли пропуски в данных. Оцените насколько их много.  '''

import matplotlib.pyplot as plt
import seaborn as sns

print(data.shape)

%matplotlib inline
fig, ax = plt.subplots(figsize=(20,12))
sns_heatmap = sns.heatmap(data.isnull(), yticklabels=False, cbar=False, cmap='viridis')
plt.show
print()
data.isna().sum()


'''Задание 3
Основываясь на выводах из предыдущего задания очистите данные от пропусков.
Подсказка: очевидно, что есть полностью пустые столбцы, неинформативные строки с одним лишь значением "For notes:", пустая часть датасета внизу. 
После этих преобразований могут остаться пустые значения в датасете с хаотичным расположением (Это допускается).
Если остались пропуски, заполните их словом "unknown"'''

data = data.drop(['Unnamed: 0'], axis=1)
data = data.drop(data[data.hotel == 'For notes:'].index)
data = data.dropna(axis=1, how='all')
data = data.dropna(axis=0, how='all')
print(data.shape)
data.fillna('unknown')


'''Задание 4
Необходимо посмотреть сколько всего записей есть в столбце 'lead_time' по каждому отелю, за каждый год и каждый месяц каждого года
Подсказка: примените метод groupby для столбцов 'hotel', 'arrival_date_year', 'arrival_date_month''''

data_gb = data.groupby(['hotel', 'arrival_date_year', 'arrival_date_month']).count()
data_gb = data_gb['lead_time']
data_gb


'''Задание 5
Узнайте размерность получившегося DataFrame (число столбцов и число строк)
Сохраните получившийся DataFrame в одном файле'''

data_gb.shape
